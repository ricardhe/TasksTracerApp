"use strict";var app=angular.module("taskTrackerApp",["ngAnimate","ngCookies","ngResource","ngRoute","ngSanitize","ngTouch"]).value("apiUrl","http://localhost:63023/").config(["$routeProvider",function(a){a.when("/",{templateUrl:"views/main.html",controller:"MainCtrl"}).when("/about",{templateUrl:"views/about.html",controller:"AboutCtrl"}).otherwise({redirectTo:"/"})}]);angular.module("taskTrackerApp").controller("MainCtrl",["$scope",function(a){a.awesomeThings=["HTML5 Boilerplate","AngularJS","Karma"]}]),angular.module("taskTrackerApp").controller("AboutCtrl",["$scope",function(a){a.awesomeThings=["HTML5 Boilerplate","AngularJS","Karma"]}]),app.factory("Workgroup",["$http","$q","workgroupSrv","User","apiUrl",function(a,b,c){function d(a){a&&this.setData(a)}return d.prototype={RelatedUsers:{},setData:function(a){angular.extend(this,a)},"delete":function(){var a=this,d=b.defer();return c.DeleteWorkGroup(this.idWorkGroup).then(function(){d.resolve(a),console.log("WorkGroup deleted: "+a.idWorkGroup)},function(a){d.reject(a.message),console.log(a.message)}),d.promise},update:function(){var a=this,d=b.defer();return c.PutWorkGroup(this).then(function(b){a.setData(b.data),d.resolve(a),console.log("WorkGroup Updated: "+b.data)},function(a){d.reject(a.message),console.log(a.message)}),d.promise},insert:function(){var a=this,d=b.defer();return c.PostWorkGroup(this).then(function(b){a.setData(b.data),d.resolve(a),console.log("WorkGroup Inserted: "+b.data)},function(a){d.reject(a.message),console.log(a.message)}),d.promise}},d}]),app.factory("workgroupManager",["$http","$q","Workgroup","workgroupSrv",function(a,b,c,d){var e={_pool:{},_retrieveInstance:function(a,b){var d=this._pool[a];return d?d.setData(b):(d=new c(b),this._pool[a]=d),d},_search:function(a){return this._pool[a]},_load:function(a,b){var c=this;d.GetWorkGroup(a).success(function(a){var d=c._retrieveInstance(a.idWorkGroup,a);b.resolve(d)}).error(function(){b.reject()})},deleteItem:function(a){this._pool[a]&&delete this._pool[a]},setItem:function(a){var b=this,c=this._search(a.idWorkGroup);return c?c.setData(a):c=b._retrieveInstance(a.idWorkGroup,a),c},getWorkGroup:function(a){var c=b.defer(),d=this._search(a);return d?c.resolve(d):this._load(a,c),c.promise},getAllWorkGroups:function(){var a=b.defer(),c=this;return d.GetWorkGroups().then(function(b){var d=[];angular.forEach(b.data,function(a){var b=c._retrieveInstance(a.idWorkGroup,a);d.push(b)}),a.resolve(d)},function(b){a.reject(b.message)}),a.promise}};return e}]),app.controller("WorkGroupCtrl",["$scope","workgroupManager","Workgroup",function(a,b,c){var d=this;d.status={message:"",state:null},d.workgroups={},d.ItemSelected=new c,this.setMessage=function(a,b){d.status.message=a,d.status.state=b},this.LoadController=function(){b.getAllWorkGroups().then(function(a){d.workgroups=a},function(){d.setMessage("Error when load the workgroups",0)})},this.SaveWorkGroup=function(){d.ItemSelected.idWorkGroup?d.ItemSelected.update().then(function(a){b.setItem(a),d.setMessage("workgroup updated satisfactory",1),d.ItemSelected=new c},function(){d.setMessage("Error inserting new workgroup",0)}):d.ItemSelected.insert().then(function(a){d.workgroups.push(a),b.setItem(a),d.ItemSelected=new c,d.setMessage("workgroup inserted satisfactory",1)},function(){d.setMessage("Error inserting new workgroup",0)})},this.deleteWorkGroup=function(a){a.delete().then(function(a){var e=d.workgroups.indexOf(a);e>-1&&(d.workgroups.splice(e,1),b.deleteItem(a.idWorkGroup)),d.status.message="workgroup delete satisfactory",d.status.state=1,d.ItemSelected=new c},function(){d.status.message="Error inserting new workgroup",d.status.state=0})},this.selectItem=function(a){d.ItemSelected=a},this.isInvalid=function(b){return a.frmWrkgrp[b].$invalid&&a.frmWrkgrp[b].$dirty},this.isValid=function(b){return a.frmWrkgrp[b].$valid&&a.frmWrkgrp[b].$dirty}}]),app.controller("TestCtrl",["$scope","workgroupManager","Workgroup",function(a,b,c){var d=this;d.status={message:"",state:null},d.workgroups={},d.ItemSelected=new c,this.setMessage=function(a,b){d.status.message=a,d.status.state=b},this.LoadController=function(){b.getAllWorkGroups().then(function(a){d.workgroups=a},function(){d.setMessage("Error when load the workgroups",0)})},this.SaveWorkGroup=function(){d.ItemSelected.idWorkGroup?d.ItemSelected.update().then(function(a){b.setItem(a),d.setMessage("workgroup updated satisfactory",1),d.ItemSelected=new c},function(){d.setMessage("Error inserting new workgroup",0)}):d.ItemSelected.insert().then(function(a){d.workgroups.push(a),b.setItem(a),d.ItemSelected=new c,d.setMessage("workgroup inserted satisfactory",1)},function(){d.setMessage("Error inserting new workgroup",0)})},this.deleteWorkGroup=function(a){a.delete().then(function(a){var e=d.workgroups.indexOf(a);e>-1&&(d.workgroups.splice(e,1),b.deleteItem(a.idWorkGroup)),d.status.message="workgroup delete satisfactory",d.status.state=1,d.ItemSelected=new c},function(){d.status.message="Error inserting new workgroup",d.status.state=0})},this.selectItem=function(a){d.ItemSelected=a},this.isInvalid=function(b){return a.frmWrkgrp[b].$invalid&&a.frmWrkgrp[b].$dirty},this.isValid=function(b){return a.frmWrkgrp[b].$valid&&a.frmWrkgrp[b].$dirty}}]),app.service("workgroupSrv",["$http","apiUrl",function(a,b){var c=b+"api/WorkGroup";this.GetWorkGroups=function(){return a.get(c)},this.GetWorkGroup=function(b){return a.get(c+"/"+b)},this.PutWorkGroup=function(b){return a.put(c+"/"+b.idWorkGroup,b)},this.PostWorkGroup=function(b){return a.post(c,b)},this.DeleteWorkGroup=function(b){return a.delete(c+"/"+b)}}]);